
----DIMENSÃO PROJETO
SELECT DISTINCT PROJECT_ID -- TEM 28 REGISTROS DE ID DO PROJETO 
FROM DW_PURCHASE_ORDER_CF

SELECT DISTINCT 
	ID_PROJECT
FROM PR_PURCHASE_ORDER --NÃO TEM NENHUM REGISTRO DE ID DO PROJETO

WITH DMPROJ AS (
    SELECT /*+ MATERIALIZE */
        ID_PROJECT,
        NO_PROJECT_ID AS PK_JOIN2
    FROM FSCORP.DM_PROJECT
    WHERE NO_PROJECT_ID IN (300000004814081, --NENHUM DOS IDS DA FATO TEM NA DIMENSÃO DE PROJETOS
300000004814369,
300000055693271,
300000054946154,
300000053281700,
300000047563302,
300000004804557,
300000004804567,
300000047563442,
300000004813022,
300000004805209,
300000055693526,
300000004665846,
300000004814183,
300000004805194,
300000004814425,
300000056193870,
300000004813012,
300000004797270,
300000053281663,
300000047563218,
300000004797260,
300000004665856,
300000004814227,
300000047563311,
300000056193824,
300000004814132
) 
   
    )
    SELECT 
    DMPROJ.ID_PROJECT,
    PROJECT_ID
    FROM DW_PURCHASE_ORDER_CF
    LEFT JOIN DMPROJ ON PROJECT_ID = PK_JOIN2
--A CONSULTA ACIMA RETORNOU VAZIOS, POIS NÃO TEM IDS NA FATO QUE TEM NA DIMENSÃO E VICE-VERSA



--DIMENSÃO TASK/PROJECT_ELEMENT
SELECT DISTINCT TASK_ID -- TEM 175 REGISTROS DE ID DO PROJETO 
FROM DW_PURCHASE_ORDER_CF


 SELECT /*+ MATERIALIZE */
            ID_PROJECT_ELEMENT,
            NO_PROJ_ELEMENT_ID AS PK_JOIN2
        FROM FSCORP.DM_PROJECT_ELEMENT
    WHERE NO_PROJ_ELEMENT_ID IN (300000004814081,
100000010461362,
100000010450686,
100000010461359,
100000010459313,
100000010450685,
100000010454806,
100000010457610,
100000010457587,
100000010456874,
100000010450843,
100000010459320,
100000010460249,
100000010459724,
100000010455131,
100000010459268,
100000010456350,
100000010459271,
100000010457360,
100000019619122,
100000019863329,
100000010465728,
100000010465716,
100000019863323,
100000013953115,
100000016426662,
100000010457606,
100000010450682,
100000010460391,
100000010450677,
100000010460382,
100000010456361,
100000010460388,
100000010461342,
100000010450673,
100000010465586,
100000010450838,
100000010460398,
100000010459321,
100000010457361,
100000010465735,
100000016420874,
100000010457612,
100000010465587,
100000010450681,
100000010461350,
100000010460397,
100000010460384,
100000010450670,
100000010457608,
100000010459311,
100000010459758,
100000010450830,
100000010460251,
100000010459295,
100000010459703,
100000010450819,
100000010459706,
100000010459719,
100000010459284,
100000010450834,
100000010450837,
100000010456870,
100000019657730,
100000010465719,
100000019657735,
100000013944315,
100000010461360,
100000010460390,
100000010465590,
100000010459310,
100000010459238,
100000010460252,
100000010459252,
100000010459748,
100000010450839,
100000010455134,
100000010465600,
100000010459256,
100000010450840,
100000010465598,
100000010456362,
100000010459243,
100000010465591,
100000010450683,
100000010459272,
100000010465594,
100000010465602,
100000010459240,
100000010460389,
100000010461358,
100000010465601,
100000010459247,
100000010456352,
100000010459682,
100000010459250,
100000010459688,
100000010459679,
100000010459755,
100000010460241,
100000010459691,
100000010465588,
100000010455140,
100000010461622,
100000010456363,
100000010465729,
100000018202762,
100000014078513,
100000010465589,
100000010459241,
100000010456347,
100000010456866,
100000010460400,
100000010459747,
100000010459730,
100000010459285,
100000010459675,
100000010457362,
100000010459281,
100000010459713,
100000010459745,
100000010459279,
100000010456872,
100000010460240,
100000010459260,
100000019619123,
100000010465727,
100000019619111,
100000010459253,
100000010465592,
100000010454814,
100000010450662,
100000010461351,
100000010460386,
100000010459323,
100000010461348,
100000010459273,
100000010456344,
100000010460250,
100000010459322,
100000010459678,
100000010459270,
100000010459269,
100000010459721,
100000010459290,
100000010459239,
100000010465734,
100000010450659,
100000010457607,
100000010459244,
100000010465593,
100000010454817,
100000010459315,
100000010465580,
100000010465583,
100000010459317,
100000010461352,
100000010457594,
100000010457609,
100000010460242,
100000010456868,
100000010459304,
100000010461631,
100000010459752,
100000010456356,
100000010461617,
100000010457346,
100000010459673,
100000010459289,
100000010461623,
100000014078532,
100000010465730,
100000019856200,
100000019657740,
100000019856218
) --A CONSULTA ACIMA RETORNOU VAZIO, POIS NÃO TEM IDS NA FATO QUE TEM NA DIMENSÃO E VICE-VERSA


---DIMENSÃO WORKER LOCATION
SELECT DISTINCT BILL_TO_LOCATION_ID  -- TEM 13 REGISTROS DE ID 
FROM DW_PURCHASE_ORDER_CF

    SELECT /*+ MATERIALIZE */
        ID_WORKER_LOCATION,
        NO_LOCATION_ID AS PK_JOIN2
    FROM FSCORP.DM_WORKER_LOCATION
    WHERE NO_LOCATION_ID IN (
300000004086083,
300000004086096,
300000004086057,
300000003991092,
300000004086070,
300000003991089,
300000004086122,
300000004086109,
300000004086018,
300000004086044,
300000004086031,
300000004086135,
300000004086005
) --NÃO RETORNOU NENHUM DOS IDS QUE TEM NA FATO ACIMA

--DIMENSÃO INVENTORY ITEM
SELECT DISTINCT INV_ITEM_ID  -- TEM 0 REGISTROS DE ID JÁ NA FONTE DO STAGING 
FROM DW_PURCHASE_ORDER_CF

SELECT DISTINCT INV_ITEM_ID, INV_ITEM_DESCRIPTION FROM DW_PURCHASE_ORDER_CF
--ESTÁ TRAZENDO NULL.


--DIMENSÃO LEGAL ENTITY
SELECT DISTINCT LEGAL_ENTITY_ID  -- TEM 13 REGISTROS DE ID_LEGAL_ENTITY
FROM DW_PURCHASE_ORDER_CF

    SELECT /*+ MATERIALIZE */
        ID_LEGAL_ENTITY,
        NO_LEGAL_ENTITY_ID AS PK_JOIN2
    FROM FSCORP.DM_LEGAL_ENTITY --CONTINUA
    WHERE NO_LEGAL_ENTITY_ID IN (
300000004075081,
300000003867397,
300000004085084,
300000004075099,
300000004075025,
300000004075117,
300000004075067,
300000004075053,
300000004085069,
300000004075039,
300000003867396,
300000004075011,
300000004075131
) --ESTÁ TRAZENDO NULL


-- DIMENSÃO WORKER LOCATION / SHIP TO LOCATION ID
SELECT DISTINCT SHIP_TO_LOCATION_ID  -- TEM 18 REGISTROS DE WORKER_LOCATION
FROM DW_PURCHASE_ORDER_CF


   SELECT /*+ MATERIALIZE */
        ID_WORKER_LOCATION,
        NO_LOCATION_ID AS PK_JOIN2
    FROM FSCORP.DM_WORKER_LOCATION --CONTNUA
    WHERE NO_LOCATION_ID IN (
300000004273055,
300000004091260,
300000004091188,
300000004091248,
300000004091152,
300000004091236,
300000004091200,
300000004091212,
300000004091077,
300000004091128,
300000004091104,
300000004091140,
300000004273043,
300000004091224,
300000004091116,
300000004091164,
300000004273067,
300000004091089
) 

-- EXPENDITURE TYPE
SELECT DISTINCT EXPENDITURE_TYPE_ID  -- TEM 3 REGISTROS DE EXPENDITURE TYPE
FROM DW_PURCHASE_ORDER_CF

SELECT /*+ MATERIALIZE */
        ID_PROJECT_EXPEDITURE_TYPE,
        NO_EXPENDITURE_TYPE_ID AS PK_JOIN2
    FROM FSCORP.DM_PROJECT_EXPENDITURE --CONTINUA
    WHERE NO_EXPENDITURE_TYPE_ID IN (
300000004665350,
300000004665344,
300000004665338
) --NÃO RETORNOU VAORES (SOMENTE NULL) 

